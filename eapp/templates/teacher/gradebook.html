{% extends 'layout/base.html' %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>Bảng điểm lớp: <span class="text-danger fw-bold">{{ my_class.name }}</span></h3>
        <a href="/teacher" class="btn btn-outline-secondary"> Quay lại </a>
    </div>

    <div class="table-responsive shadow-sm">
        <table class="table table-bordered table-striped align-middle mb-0">
            <thead class="table-dark text-center">
                <tr>
                    <th>Mã HV</th>
                    <th>Họ tên</th>

                    {% for type in ScoreType %}
                        <th>{{ type.name }}</th>
                    {% endfor %}

                    <th>Trung bình</th>
                    <th>Kết quả</th>
                </tr>
            </thead>

            <tbody>
                {% for s in students %} {% set stat = calc_stats(s.id) %}
                <tr class="student-row">
                    <td class="text-center">{{ s.user.id }}</td>
                    <td>{{ s.user.name }}</td>

                    {% for type in ScoreType %}
                    <td>
                        <input type="number"
                               class="form-control score-input"
                               value="{{ get_score(s, type) }}"
                               min="0"
                               max="10"
                               step="0.1"
                               onchange="updateScore(this, {{ s.id }}, {{ type.value }})">
                    </td>
                    {% endfor %}

                    <td class="text-center fw-bold text-primary avg-score">{{ stat.avg }}</td>
                    <td class="text-center fw-bold result-text">{{ stat.result }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="msg" class="fixed-bottom p-3 bg-success text-white text-center fw-bold"
         style="display:none; width: 200px; right: 20px; left: auto; bottom: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">Đã lưu điểm!
    </div>
</div>

<script src="{{ url_for('static', filename='js/gradebook.js') }}"></script>
{% endblock %}